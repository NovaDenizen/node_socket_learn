<!doctype html>
<html>

  <head>

  </head>
  <body>
    <h1>I am alive!!</h1>

    <input type="button" value="get new data" id="newdatabutton">
    <div id="newdata">no data yet</div>
    <script src="socket.io/socket.io.js"></script>

    <script>
      var URL_SERVER = 'https://www.cymbym.com:58001';
      var socket = io.connect(URL_SERVER);

      socket.on('message', function(data) {
        alert(data);
      });
      socket.on('newdata', function(data) {
          let nd_div = document.getElementById('newdata');
          nd_div.textContent = '';
          for (i = 0; i < data.length; i++) {
              let row = data[i];
              let line = '';
              for ([key, value] of Object.entries(row)) {
                  line = line + ` ${key}:${value}`;
              }
              const node = document.createTextNode(line);
              const p = document.createElement('p');
              p.appendChild(node);
              nd_div.appendChild(p);
          }
      });
      let newdatabutton = document.getElementById('newdatabutton');
      newdatabutton.onclick = function() {
          socket.emit('getnewdata');
      };

    </script>
  </body>

</html>
